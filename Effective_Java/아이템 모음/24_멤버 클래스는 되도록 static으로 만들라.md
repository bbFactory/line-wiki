# 4장. 클래스와 인터페이스(p95~152)

## 아이템 24. 멤버 클래스는 되도록 static으로 만들라(p146~149)

> **중첩 클래스**(nested class)란 다른 클래스 안에 정의된 클래스를 말한다. 중첩 클래스는 자신을 감싼 바깥 클래스에서만 쓰여야 하며, 그 외의 쓰임새가 있다면 톱레벨 클래스로 만들어야 한다.
>
> 중첩 클래스의 종류는 **정적 멤버 클래스, (비정적) 멤버 클래스, 익명 클래스, 지역 클래스** 네 가지다. 이 중 첫 번째를 제외한 나머지는 내부 클래스(inner class)에 해당한다.
>
> 이번 아이템에서는 각각의 중첩 클래스를 언제 그리고 왜 사용해야 하는지 이야기한다.

## 정적 멤버 클래스

정적 멤버 클래스는 기본적으로 다른 클래스 안에 선언되고, 바깥 클래스의 private 멤버에 접근 가능하다. 그리고 다른 정적 멤버와 똑같은 방법으로 접근 가능하다. 이 점을 제외하고는 일반 클래스와 동일하게 사용된다. 

**바깥 클래스의 public 도우미 클래스가 필요할 때 정적 멤버 클래스를 유용하게 쓸 수 있다.** 예를 들어 Calculator 클래스 안에 연산 종류를 정의하고자 할 때, public 정적 멤버 클래스로 Operation 열거 타입을 만든다. 그러면 Calculator의 클라이언트에서 Calculator.Operation.PLUS 나 Calculator.Operation.MINUS 로 사용할 수 있다. 

만약 중첩 클래스의 인스턴스가 바깥 클래스의 인스턴스와 독립적으로 존재하길 원한다면 중첩 클래스를 정적 멤버 클래스로 만들어야 한다.

정적 멤버 클래스를 private 흔히 바깥 클래스가 표현하는 객체의 한 부분(구성요소)을 나타낼 때 쓴다.

## 비정적 멤버 클래스

**비정적 멤버 클래스는 어댑터를 정의할 때 자주 쓰인다.** 클래스의 인스턴스를 **마치 다른 클래스의 인스턴스처럼 보이고자 할 때(뷰로 사용하고자 할 때)** 비정적 멤버 클래스를 사용한다. 예를 들어 Set과 List 컬렉션 인터페이스 구현체가 자신의 반복자를 구현할 때 비정적 멤버 클래스를 사용한다.

```java
import java.util.AbstractSet;
import java.util.Iterator;

public class MySet<E> extends AbstractSet<E> {
    ... // 생략

    @Override
    public Iterator<E> iterator() {
        return new MyIterator();
    }

    // 비정적 멤버 클래스
    private class MyIterator implements Iterator<E> {
        ...
    }
}
```

한편, **멤버 클래스에서 바깥 인스턴스에 접근해야 하는 경우, 멤버 클래스 앞에 반드시 static을 붙이자**(정적 멤버 클래스로 쓰라는 의미다). 만약 멤버 앞에 static이 없을 경우, 바깥 인스턴스로부터 참조가 시작되므로 참조를 저장할 때 낭비가 발생한다.

## 익명 클래스

- 익명 클래스는 말그대로 이름이 없는 클래스이다. 

- 바깥 클래스의 멤버는 아니다. 

- 일반적인 멤버와 달리, **쓰이는 시점에 선언과 동시에 인스턴스가 만들어진다.**  

- 위치와 상관없이 작성할 수 있지만 다음 상황에서 쓰는 게 좋다.

  > 한 메서드 안에서만 쓰이고,
  > 인스턴스를 단 한 곳에서만 생성하며,
  > 해당 타입의 클래스나 인터페이스를 이미 가지고 있는 경우

- static이 아닌 곳이면 바깥 클래스의 인스턴스를 참조할 수 있다(이 외에는 참조 불가능하다).

- static 문맥 안이라도 상수 변수 외의 정적 멤버를 가질 수 없다. 상수 표현을 위해 초기화된 final 기본 타입과 문자열 필드만 가질 수 있다.

- instanceof 검사나 클래스의 이름이 필요한 작업은 수행할 수 없다.

- 여러 인터페이스를 구현할 수 없고, 인터페이스를 구현하는 동시에 다른 클래스를 상속할 수 없다.

- 상위 타입에서 상속한 멤버 외에는 호출할 수 없다. 

- 표현식 중간에 등장하므로 (10줄 이하로) 짧지 않으면 가독성이 떨어진다. 

- 정적 팩터리 메서드를 구현할 때 주로 사용된다(앞의 intArrayAsList 참조).

## 지역 클래스

- 네 가지 중첩 클래스 중 가장 드물게 사용된다.
- 지역변수를 선언할 수 있는 곳이면 실질적으로 어디서든 선언할 수 있고, 유효 범위도 지역변수와 같다.
- 멤버 클래스처럼 이름이 있고 반복해서 사용할 수 있다.
- 익명 클래스처럼 비정적 문맥에서 사용될 때만 바깥 인스턴스를 참조할 수 있다. 정적 멤버는 가질 수 없으며, 가독성을 위해 짧게 작성해야 한다.
- 만약, 메서드 밖에서도 쓰인다거나 정의하는 내용이 너무 길다면 (지역 클래스 대신) 멤버 클래스를 사용하자.


