# 7장. 람다와 스트림(p253~296)

> 자바 8에서 **함수형 인터페이스, 람다, 메서드 참조**가 추가되면서 함수 객체를 더 쉽게 만들 수 있게 되었다. 이와 함께 **스트림 API**까지 추가되어 데이터 원소의 시퀀스 처리를 라이브러리 차원에서 지원하기 시작했다. 
>
> 이번 장에서는 이 기능들을 효과적으로 사용하는 방법을 알아보려 한다.

## 아이템 47. 반환 타입으로는 스트림보다 컬렉션이 낫다.(p284~290)

공개 API를 만들 경우, 일련의 원소들을 반환하는 메서드는 어떤 반환 타입을 가져야 할까? 스트림(Stream)? 컬렉션(Collection)?  

일련의 원소들을 반환하기 때문에 스트림 타입으로 반환해야겠다고 생각할 수 있다. 하지만 스트림은 Iterable을 확장(extend)하지 않기 때문에 메서드의 반환값으로 for-each 반복문을 사용하기 원하는 사용자들을 만족시킬 수 없다. 

반면 Collection 인터페이스는 Iterable의 하위 타입이면서 stream 메서드도 동시에 제공한다. 즉, 반복문을 원하는 사용자와 스트림을 원하는 사용자 모두를 만족시킬 수 있는 것이다. 결론적으로 **원소 시퀀스를 반환하는 공개 API 메서드라면 반환 타입으로 Collection이나 그 하위 타입을 쓰는 게 가장 좋다.**

하지만 여기에서 예외 케이스가 있다. 반환하는 시퀀스의 크기가 너무 크다면 컬렉션은 좋은 선택이 아니다. 메모리 사용이 기하급수적으로 늘어나기 때문이다. 이 경우 시퀀스를 본래의 크기보다 간결하게 표현하는 전용 컬렉션을 별도로 구현하거나 스트림 또는 Iterable을 반환하는 것이 낫다. 책에 있는 멱집합 구현 예시를 참고하자(p286)).

## 마무리

- 반환 전부터 이미 원소들을 컬렉션에 담아 관리하고 있다면, 또는 컬렉션을 하나 더 만들어도 될 정도로 원소 개수가 적다면 ArrayList 같은 표준 컬렉션에 담아 반환하자.
- 그렇지 않으면 앞서의 멱집합 예처럼 전용 컬렉션을 구현할지 고민하자.
- 컬렉션을 반환하는 게 불가능하면 스트림과 Iterable 중 더 자연스러운 것을 반환하자.
- 나중에 Stream 인터페이스가 Iterable을 지원하도록 자바가 수정된다면, 그때는 안심하고 스트림을 반환하면 될 것이다(스트림 처리와 반복 모두에 사용할 수 있으니)


