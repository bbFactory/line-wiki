# 10장. 예외(p385~412)

> 이번 장에서는 예외를 효과적으로 활용하는 지침을 다룬다.

## 아이템 72. 표준 예외를 사용하라(p396~398)

일반적으로 예외 처리를 할 때 자바 라이브러리에서 제공하는 예외를 (재)사용하는 것을 추천한다. 표준 예외를 재사용하면 얻는 게 많기 때문이다. 

- **이점 1**: 새로 만든 API가 다른 사람이 익히고 사용하기 쉬워진다.
- **이점 2**: 새로 만든 API를 사용한 프로그램도 낯선 예외를 사용하지 않게 되어 읽기 쉽게 된다.
- **이점 3**: 예외 클래스 수가 적을수록 메모리 사용량이 줄고 클래스를 적재하는 시간도 적게 걸린다.

### 자주 재사용되는 예외들

- **IllegalArgumentException**(아이템 49): 호출자가 인수로 부적절한 값을 넘길 때 던지는 예외로, 예를 들어 반복 횟수를 지정하는 매개변수에 음수를 건넬 때 쓸 수 있다.
- **IllegalStateException**: 대상 객체의 상태가 호출된 메서드를 수행하기에 적합하지 않을 때 주로 던진다. 예컨대 제대로 초기화되지 않은 객체를 사용하려 할 때 던질 수 있다.
- **NullPointerException**: null 값을 허용하지 않는 메서드에 null을 건넬 때 던질 수 있다.
- **IndexOutOfBoundsException**: 어떤 시퀀스의 허용 범위를 넘는 값을 건넬 때 던질 수 있다.
- **ConcurrentModificationException**: 단일 스레드에서 사용하려고 설계한 객체를 여러 스레드가 동시에 수정하려 할 때 던진다(외부 동기화 방식으로 사용하려고 설계한 객체도 마찬가지다).
- **UnsupportedOperationException**: 클라이언트가 요청한 동작을 대상 객체가 지원하지 않을 때 던진다. 보통은 구현하려는 인터페이스의 메서드 일부를 구현할 수 없을 때 쓴다. 예를 들어 원소를 넣을 수만 있는 List 구현체인데 누군가 remove 메서드를 호출하면 이 예외를 던질 것이다.

### 표 정리

| 예외                            | 주요 쓰임                                                    |
| ------------------------------- | ------------------------------------------------------------ |
| IllegalArgumentException        | 허용하지 않는 값이 인수로 건네졌을 때(null은 따로 NullPointerException으로 처리) |
| IllegalStateException           | 객체가 메서드를 수행하기에 적절하지 않은 상태일 때           |
| NullPointerException            | null을 허용하지 않는 메서드에 null을 건넸을 때               |
| IndexOutOfBoundsException       | 인덱스가 범위를 넘어섰을 때                                  |
| ConcurrentModificationException | 허용하지 않는 동시 수정이 발견됐을 때                        |
| UnsupportedOperationException   | 호출한 메서드를 지원하지 않을 때                             |

### 주의할 사항

앞서 정리한 예외의 쓰임이 상호 배타적이지 않기 때문에, 종종 재사용할 예외를 선택하기 어려울 때도 있다. 

> 예를 들어 카드 덱을 표현하는 객체가 있고, 인수로 건넨 수만큼의 카드를 뽑아 나눠주는 메서드를 제공한다고 해보자. 이때 덱에 남아 있는 카드 수보다 큰 값을 건네면 어떤 예외를 던져야 할까? 인수의 값이 너무 크다고 본다면 IllegalArgumentException을, 덱에 남은 카드 수가 너무 적다고 본다면 IllegalStateException을 선택할 것이다. 이런 상황에서의 일반적인 규칙은 이렇다. **인수 값이 무엇이었든 어차피 실패했을 거라면 IllegalStateException을, 그렇지 않으면 IllegalArgumentException을 던지자.**

**Exception, RuntimeException, Throwable, Error는 직접 재사용하지 말자.** 이 클래스들은 추상 클래스라고 생각하면 된다. 이 예외들은 다른 예외들의 상위 클래스이며, 여러 성격의 예외들을 포괄하는 클래스이므로 안정적으로 테스트할 수 없다.

표준 예외를 재사용하더라도, 예외의 이름과 예외가 던져지는 맥락(상황)에 부합할 경우에만 재사용하자. 더 많은 정보를 제공하길 원한다면 표준 예외를 확장해도 좋다. 단, 예외는 직렬화할 수 있다(12장), (직렬화에는 많은 부담이 따르니) 커스텀한 예외를 새로 만들지 않아야 할 근거로 충분할 수 있다.


