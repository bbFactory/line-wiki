# 2장. 객체 생성과 파괴(p7~94)

## 아이템 6. 불필요한 객체 생성을 피하라(p31~35)

한 객체가 똑같은 자원을 가지거나 똑같은 기능을 수행한다면, 매번 객체를 생성하기보다 **불변인 객체를 만들고 이를 재사용**하는 편이 나을 때가 많다. 대표적인 예로 String 객체를 생각해볼 수 있다.

```java
String capital = new String("Seoul"); // 좋지 않은 코드
```

만약 위의 코드가 반복문 블록 안에 있다면 새로운 String 인스턴스를 계속 생성할 것이다. 반복문이 수천 번 실행된다고 하면 쓸데없이 생성을 하고 있는 것이다. 이를 대신해 아래와 같이 코드를 개선하자.

```java
String capital = "Seoul";
```

위의 코드는 하나의 String 인스턴스를 사용한다. 뿐만 아니라 동일한 가상 머신에서 똑같은 문자열 리터럴을 가지는 코드가 있다면 객체를 재사용하여 사용할 수 있다.

**정적 팩터리 메서드 방식으로도 불필요한 객체 생성을 피할 수 있다.** 생성자는 호출할 때마다 새로운 객체를 만들지만, 팩터리 메서드는 전혀 그렇지 않다. Boolean(String) 생성자 대신 Boolean.valueOf(String) 팩터리 메서드로 객체를 생성해보면 알 수 있는 부분이다. 

또한 **생성 비용이 비싼 객체를 반복해서 사용할 경우 객체를 캐싱하여 재사용하자.**

한편, 오토박싱은 불필요한 객체 생성을 일으킬 수 있다.

```java
private static long sum() {
    Long sum = 0L;
    for (long i = 0; i <= Integer.MIN_VALUE; i++) {
        sum += i;
    }
    
    return sum;
}
```

이 경우, long 타입인 i가 Long 타입인 sum에 더해질 때마다 (오토 박싱으로 인해) Long 인스턴스가 약 2^31개나 만들어진다. 분명 불필요한 객체 생성이다. 따라서 **의도한 경우가 아니라면 박싱된 기본 타입보다는 기본 타입을 사용하자.** 

> 오해해서는 안 될 부분은 "객체 생성은 언제나 비싸니 피해야 해"가 아니라는 점이다. **프로그램의 명확성, 간결성, 기능을 위해서 객체를 추가로 생성하는 것이라면 일반적으로 좋은 일이다.**

